p=lambda g,s=0:[g:=[*zip(*sum(u:=g[0])//9*(s==0)and[(u,[*u[(s:=(r[-1]%8-r[0]%8>>1)+s):]]+~-s*[0]+(a:=[2*(2in r)]),a+~s*[0]+[*u[:s]])[(s|8)//9]for r in g]or g)][::-1]for _ in g][3]