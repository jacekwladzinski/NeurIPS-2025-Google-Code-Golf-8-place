def p(e):
 t,n,i,p=[t for e in[e,zip(*e)]for t,a in enumerate(e)if 4in a];r=[a[i:p+1]for a in e[t:n+1]]
 for a in e[t:n+1]:a[i]=a[p]=0;n=[*zip(*filter(any,zip(*filter(any,e))))]
 for t,a in enumerate(n):
  for e,a in enumerate(a):r[t+1][[p-i+~e,e+1][r[1][0]in[*zip(*n)][0]]]=a
 return r